name: $(BuildID)

resources:
  repositories:
  - repository: public
    type: github
    name: kipters/CrossNews
    endpoint: kipters

variables:
  ANDROID_NDK_PATH: 'C:\Microsoft\AndroidNDK64\android-ndk-r15c'
  ANDROID_NDK_HOME: 'C:\Microsoft\AndroidNDK64\android-ndk-r15c'
  buildConfiguration: 'Release'
  outputDirectory: '$(build.binariesDirectory)/$(buildConfiguration)'
  solution: 'CrossNews.sln'

trigger:
  - master

jobs:
- job: android
  displayName: Android build
  continueOnError: true
  pool:
    vmImage: 'vs2017-win2016'
  steps:
  - task: NuGetToolInstaller@0
    displayName: 'Use NuGet 4.4.1'
    inputs:
      versionSpec: 4.4.1
  
  - task: NugetCommand@2
    displayName: 'NuGet restore'
    inputs:
      restoreSolution: $(solution)

  - task: XamarinAndroid@1
    displayName: 'Build Xamarin.Android project'
    inputs:
      projectFile: 'CrossNews.Droid\CrossNews.Droid.csproj'
      outputDirectory: $(outputDirectory)
      configuration: $(buildConfiguration)
